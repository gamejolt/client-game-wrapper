sudo: false
language: rust
rust:
  - stable
  - beta

matrix:
  allow_failures:
    - rust: nightly

os:
  - linux
  - osx

addons:
  apt:
    sources:
      - ubuntu-toolchain-r-test
    packages:
      - gcc-4.9
      - g++-4.9
      - gcc-4.9-multilib
      - g++-4.9-multilib
  artifacts:
    paths:
      - ./target/release/game_jolt_game_wrapper

before_install:
  - rustc -V
  - cargo -V
  - git submodule update --init --recursive
  - git clone https://github.com/creationix/nvm.git ./.nvm
  - source ./.nvm/nvm.sh
  - nvm install stable
  - nvm use stable
  - npm install -g gulp tsd

install:
  - npm i
  - tsd rate
  - tsd install

before_script:
  - cargo test --verbose
  - gulp build

script:
  - npm test
